// Changes DOWNED so when succeeding on the death saving throws only stabilizes the character
new entry "DOWNED"
type "StatusData"
data "StatusType" "DOWNED"
using "DOWNED"
data "Description" "h788b3d9dgb19cg43adg8d49gdb0f922e7400;1"
data "DescriptionParams" "RegainHitPoints(1)"
data "OnSuccess" "ApplyStatus(RAW_STABILIZED,100,-1)"

// Help requires a Medicine Skill Check, and also only stabilizes the character
new entry "Target_Help"
type "SpellData"
data "SpellType" "Target"
using "Target_Help"
data "SpellRoll" "not IsDowned() or SkillCheck(Skill.Medicine,10)"
data "SpellSuccess" "IF(IsDowned()):ApplyStatus(RAW_STABILIZED,100,-1)"
data "SpellProperties" "RemoveStatus(SG_Helpable_Condition);RemoveStatus(BURNING);RemoveStatus(SG_Prone);RemoveStatus(SG_Restrained);RemoveStatus(PRONE);RemoveStatus(SLEEPING);RemoveStatus(SLEEP);RemoveStatus(ENSNARING_STRIKE);RemoveStatus(WEB);RemoveStatus(HYPNOTIC_PATTERN)"
data "Description" "h32d73faeg184cg419bg8fb6gdd67958d7817;1"
data "ExtraDescription" "h53da955bgfbadg4d77gb962g11eec4070db8;1"

// The RAW_STABILIZED status gives the RAW_Stabilized passive, which restores 1HP when out of combat
new entry "RAW_STABILIZED"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "RAW_STABILIZED"
data "DisplayName" "h5df0213dg5488g435dgab52g6b9520c0b521;1"
data "Description" "h4507b659g8c44g4f43gaf5cgb83ac55eec62;1"
data "Icon" "PassiveFeature_Generic_Death"
data "DescriptionParams" "RegainHitPoints(1)"
data "OnApplyFunctors" "Stabilize()"
data "RemoveEvents" "OnDamage"
data "Passives" "RAW_Stabilized"

new entry "RAW_Stabilized"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnCombatEnded"
data "StatsFunctors" "IF(not Combat(context.Source)):RegainHitPoints(1);IF(not Combat(context.Source)):RemoveStatus(RAW_STABILIZED)"
