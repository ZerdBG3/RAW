new entry "Backstab"
type "PassiveData"
data "DisplayName" "Passive_Backstab_DisplayName"
data "Description" "Passive_Backstab_Description"
data "Properties" "IsHidden"
data "Boosts" ""

new entry "ShortResting"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctors" "ApplyStatus(SELF,DND_SHORT_REST,100,-1);"
data "StatsFunctorContext" "OnShortRest"

new entry "Hex"
type "PassiveData"
data "DisplayName" "Passive_Hex_DisplayName"
data "Description" "Passive_Hex_Description"
data "DescriptionParams" "DealDamage(1d6,Necrotic)"
data "Conditions" "HasHexStatus() and (IsAttack() or context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack or context.HitDescription.AttackType==AttackType.RangedOffHandWeaponAttack) and HasDamageEffectFlag(DamageFlags.Hit)"
data "StatsFunctors" "ApplyStatus(PASSIVE_HEX,100,0);DealDamage(1d6,Necrotic)"
data "StatsFunctorContext" "OnAttack"

new entry "HuntersMark"
type "PassiveData"
data "DisplayName" "Passive_HuntersMark_DisplayName"
data "Description" "Passive_HuntersMark_Description"
data "DescriptionParams" "DealDamage(1d6,MainMeleeWeaponDamageType)"
data "Conditions" "HasStatus('HUNTERS_MARK',context.Target,context.Source) and IsWeaponAttack() and HasDamageEffectFlag(DamageFlags.Hit)"
data "StatsFunctors" "ApplyStatus(PASSIVE_HUNTERS_MARK,100,0);IF(context.HitDescription.AttackType==AttackType.MeleeWeaponAttack):DealDamage(1d6, MainMeleeWeaponDamageType);IF(context.HitDescription.AttackType==AttackType.RangedWeaponAttack):DealDamage(1d6, MainRangedWeaponDamageType);IF(context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack):DealDamage(1d6, OffhandMeleeWeaponDamageType);IF(context.HitDescription.AttackType==AttackType.RangedOffHandWeaponAttack):DealDamage(1d6, OffhandRangedWeaponDamageType);"
data "StatsFunctorContext" "OnAttack"

new entry "ColossusSlayer"
type "PassiveData"
data "DisplayName" "Passive_ColossusSlayer_DisplayName"
data "Description" "Passive_ColossusSlayer_Description"
data "Conditions" "IsWeaponAttack() and HasDamageEffectFlag(DamageFlags.Hit) and (((context.HitDescription.TotalDamageDone + context.Target.HP) / context.Target.HP) * context.Target.HPPercentage) < 100"
data "Properties" "OncePerTurn"
data "StatsFunctors" "IF(context.HitDescription.AttackType==AttackType.MeleeWeaponAttack):DealDamage(1d8, MainMeleeWeaponDamageType);IF(context.HitDescription.AttackType==AttackType.RangedWeaponAttack):DealDamage(1d8, MainRangedWeaponDamageType);IF(context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack):DealDamage(1d8, OffhandMeleeWeaponDamageType);IF(context.HitDescription.AttackType==AttackType.RangedOffHandWeaponAttack):DealDamage(1d8, OffhandRangedWeaponDamageType);"
data "StatsFunctorContext" "OnDamage"

new entry "SneakAttack"
type "PassiveData"
data "DisplayName" "Passive_DnD_SneakAttack_DisplayName"
data "Description" "Passive_DnD_SneakAttack_Description"
data "DescriptionParams" "DealDamage(1d6,MainMeleeWeaponDamageType)"
data "Icon" "Action_SneakAttack_Melee"
data "Conditions" "(IsRangedAttack() or (context.HitDescription.AttackType==AttackType.MeleeWeaponAttack and WieldingWeapon('Finesse', false, false, context.Source)) or (context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack and WieldingWeapon('Finesse', true, false, context.Source))) and (HasAdvantage() or (HasAllyWithinRange('SG_Incapacitated',2) and not HasDisadvantage())) and HasDamageEffectFlag(DamageFlags.Hit) and HasActionResource('SneakAttack',1,0,false,context.Source)"
data "Properties" "IsToggled;ToggledDefaultOn;ToggledDefaultAddToHotbar"
data "StatsFunctors" "UseActionResource(SELF,SneakAttack,1);IF(context.HitDescription.AttackType==AttackType.MeleeWeaponAttack):DealDamage(1d6, MainMeleeWeaponDamageType);IF(context.HitDescription.AttackType==AttackType.RangedWeaponAttack):DealDamage(1d6, MainRangedWeaponDamageType);IF(context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack):DealDamage(1d6, OffhandMeleeWeaponDamageType);IF(context.HitDescription.AttackType==AttackType.RangedOffHandWeaponAttack):DealDamage(1d6, OffhandRangedWeaponDamageType);"
data "StatsFunctorContext" "OnAttack"

new entry "SneakAttack_2"
type "PassiveData"
data "DisplayName" "Passive_DnD_SneakAttack_DisplayName"
data "Description" "Passive_DnD_SneakAttack_Description"
data "DescriptionParams" "DealDamage(2d6,MainMeleeWeaponDamageType)"
data "Icon" "Action_SneakAttack_Melee"
data "Conditions" "(IsRangedAttack() or (context.HitDescription.AttackType==AttackType.MeleeWeaponAttack and WieldingWeapon('Finesse', false, false, context.Source)) or (context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack and WieldingWeapon('Finesse', true, false, context.Source))) and (HasAdvantage() or (HasAllyWithinRange('SG_Incapacitated',2) and not HasDisadvantage())) and HasDamageEffectFlag(DamageFlags.Hit) and HasActionResource('SneakAttack',1,0,false,context.Source)"
data "Properties" "IsToggled;ToggledDefaultOn;ToggledDefaultAddToHotbar"
data "StatsFunctors" "UseActionResource(SELF,SneakAttack,1);IF(context.HitDescription.AttackType==AttackType.MeleeWeaponAttack):DealDamage(2d6, MainMeleeWeaponDamageType);IF(context.HitDescription.AttackType==AttackType.RangedWeaponAttack):DealDamage(2d6, MainRangedWeaponDamageType);IF(context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack):DealDamage(2d6, OffhandMeleeWeaponDamageType);IF(context.HitDescription.AttackType==AttackType.RangedOffHandWeaponAttack):DealDamage(2d6, OffhandRangedWeaponDamageType);"
data "StatsFunctorContext" "OnAttack"

new entry "DualWielder_BonusAC"
type "PassiveData"
data "DisplayName" "Passive_DualWielder_BonusAC_DisplayName"
data "Description" "Passive_DualWielder_BonusAC_Description"
data "Boosts" "IF(FightingStyle_TwoWeapons(context.Source)):AC(1)"

new entry "ArcaneWard"
type "PassiveData"
data "DisplayName" "Passive_ArcaneWard_DisplayName"
data "Description" "Passive_ArcaneWard_Description"
data "DescriptionParams" "RegainHitPoints(2*Level+IntelligenceModifier)"
data "Conditions" "context.HitDescription.SpellSchool == SpellSchool.Abjuration and context.HitDescription.SpellLevel > 0"
data "StatsFunctors" "IF(HasStatus('ARCANE_WARD_HELPER',context.Source) and context.HitDescription.SpellPowerLevel == 1):ApplyStatus(SELF,ARCANE_WARD_REPLENISH_1,100,-1);IF(HasStatus('ARCANE_WARD_HELPER',context.Source) and context.HitDescription.SpellPowerLevel == 2):ApplyStatus(SELF,ARCANE_WARD_REPLENISH_2,100,-1);IF(not HasStatus('ARCANE_WARD_HELPER',context.Source)):ApplyStatus(SELF,ARCANE_WARD,100,-1)"
data "StatsFunctorContext" "OnAttack"

new entry "FastHands"
type "PassiveData"
data "DisplayName" "Passive_FastHands_DisplayName"
data "Description" "Passive_FastHands_Description"
data "Boosts" "UnlockSpell(Target_Help_CunningAction)"

new entry "SecondStoryWork"
type "PassiveData"
data "DisplayName" "Passive_SecondStoryWork_DisplayName"
data "Description" "Passive_SecondStoryWork_Description"
data "Boosts" "FallDamageMultiplier(0.5);UnlockSpell(Projectile_Jump_Thief)"

new entry "SearingSmite"
type "PassiveData"
data "DisplayName" "Passive_SearingSmite_DisplayName"
data "Description" "Passive_SearingSmite_Description"
data "DescriptionParams" "DealDamage(1d6,Fire)"
data "Conditions" "(context.HitDescription.AttackType==AttackType.MeleeWeaponAttack or context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack) and HasDamageEffectFlag(DamageFlags.Hit)"
data "StatsFunctors" "DealDamage(1d6,Fire);RemoveStatus(SELF,SEARING_SMITE_INITIAL);ApplyStatus(SEARING_SMITE,100,10)"
data "StatsFunctorContext" "OnAttack"
data "Properties" "IsHidden"

new entry "SearingSmite_2"
type "PassiveData"
data "DisplayName" "Passive_SearingSmite_DisplayName"
data "Description" "Passive_SearingSmite_Description"
data "DescriptionParams" "DealDamage(1d6,Fire)"
data "Conditions" "(context.HitDescription.AttackType==AttackType.MeleeWeaponAttack or context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack) and HasDamageEffectFlag(DamageFlags.Hit)"
data "StatsFunctors" "DealDamage(2d6,Fire);RemoveStatus(SELF,SEARING_SMITE_INITIAL_2);ApplyStatus(SEARING_SMITE,100,10)"
data "StatsFunctorContext" "OnAttack"
data "Properties" "IsHidden"
